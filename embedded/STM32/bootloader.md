# bootloader升级程序设计

## 空间划分

### 内部flash划分

- 空间大小: 内部flash空间512K, 划分为256页, 每页大小2K
- 地址映射: 内部flash起始地址0x0800 0000, 结束地址0x0807 FFFF
- 划分给bootloader的大小为32K, 即0x8000, 所以其起始地址应设置为 $0x0807\  FFFF- 0x8000 = 0x0807\ 7FFF$
- 划分给app的大小为 $512K - 32K = 480K = 0x7\ 8000$, 起始地址为 0x0800 0000

### 外部flash划分

- 外部flash使用 $W25Q64BV: 64M-bit$ 的芯片, 存储空间共8M Byte, 使用$SPI$总线与$MCU$通信
- 由于app的大小不可能超过480K, 则在外部flash的尾端分配512K空间即可, 剩下的32K空间留作余量, 为后期加上其他信息, 如升级文件的大小, 其实地址等信息做准备

## 简易ttu软件

## bootloader软件
